?commandArgs
library(phytools)
?ancThresh
source('~/Documents/Salamanders/Rscripts/flux_files/extinct_neot.R', chdir = TRUE)
?commandArgs
library(parallel)
library(doParallel)
?foreach
mpi.universe.size()
library(Rmpi)
Path_base <- "~/Desktop/mitchell/Salamanders/"#
#Path_base <- "/scratch/drabosky_flux/jonsmitc/Salamanders/"#
#
library(phytools)#
library(parallel)#
library(doParallel)#
library(foreach)#
cl <- makeCluster(2)#
registerDoParallel(cl)#
#
# Read in neoteny scores#
setwd(paste(Path_base, "neoteny", sep=""))#
neoteny <- read.csv("neoteny.csv", stringsAsFactors=F)#
spNames <- apply(neoteny, 1, function(x) paste(x[1], x[2], sep="_", collapse=""))#
neoteny <- neoteny[,3]#
names(neoteny) <- spNames#
Alpha <- 1#
Cols <- c(rgb(254/255, 237/255, 222/255, Alpha), rgb(253/255, 190/255, 133/255, Alpha), rgb(253/255, 141/255, 60/255, Alpha), rgb(217/255, 71/255, 1/255, Alpha))#
names(Cols) <- c("-1", "0", "1", "2")#
#
foreach(count=1:2) %dopar$ {#
	setwd(paste(Path_base, "bamm/output-", count, sep=""))#
	tree <- read.tree("fullTree.tre")#
#
	PrA <- matrix(rep(0.01666667, length(Cols)), nrow=1)#
	colnames(PrA) <- names(Cols)#
	rownames(PrA) <- Ntip(tree) + 1#
	PrA[1,"0"] <- 1 - (3 * PrA[1,"1"])#
	Ngen <- 5e6#
#
	ACE <- ancThresh(tree, neoteny[tree$tip.label], ngen=Ngen, sequence=colnames(PrA), control=list(sample=Ngen/1e3, propthresh=0.15*max(nodeHeights(tree)), propliab=0.75*max(nodeHeights(tree)), burnin=Ngen*0.1, piecol=Cols, tipcol="input", pr.anc=PrA, plot=F))#
	setwd(paste(Path_base, "output", sep=""))#
	save(ACE, file=paste(Path_base, "output/neotAnc/neotAnc", count, ".RData", sep=""))#
}
?foreach
foreach(i=1:2) %dopar$ {#
	setwd(paste(Path_base, "bamm/output-", i, sep=""))#
	tree <- read.tree("fullTree.tre")#
#
	PrA <- matrix(rep(0.01666667, length(Cols)), nrow=1)#
	colnames(PrA) <- names(Cols)#
	rownames(PrA) <- Ntip(tree) + 1#
	PrA[1,"0"] <- 1 - (3 * PrA[1,"1"])#
	Ngen <- 5e6#
#
	ACE <- ancThresh(tree, neoteny[tree$tip.label], ngen=Ngen, sequence=colnames(PrA), control=list(sample=Ngen/1e3, propthresh=0.15*max(nodeHeights(tree)), propliab=0.75*max(nodeHeights(tree)), burnin=Ngen*0.1, piecol=Cols, tipcol="input", pr.anc=PrA, plot=F))#
	setwd(paste(Path_base, "output", sep=""))#
	save(ACE, file=paste(Path_base, "output/neotAnc/neotAnc", i, ".RData", sep=""))#
}
foreach(i=1:2) %dopar% {#
	setwd(paste(Path_base, "bamm/output-", i, sep=""))#
	tree <- read.tree("fullTree.tre")#
#
	PrA <- matrix(rep(0.01666667, length(Cols)), nrow=1)#
	colnames(PrA) <- names(Cols)#
	rownames(PrA) <- Ntip(tree) + 1#
	PrA[1,"0"] <- 1 - (3 * PrA[1,"1"])#
	Ngen <- 5e6#
#
	ACE <- ancThresh(tree, neoteny[tree$tip.label], ngen=Ngen, sequence=colnames(PrA), control=list(sample=Ngen/1e3, propthresh=0.15*max(nodeHeights(tree)), propliab=0.75*max(nodeHeights(tree)), burnin=Ngen*0.1, piecol=Cols, tipcol="input", pr.anc=PrA, plot=F))#
	setwd(paste(Path_base, "output", sep=""))#
	save(ACE, file=paste(Path_base, "output/neotAnc/neotAnc", i, ".RData", sep=""))#
}
#### Net div calculations#
Path_base <- "~/Documents/Salamanders/"#
#
library(phytools)#
library(BAMMtools)#
library(coda)#
source(paste(Path_base, 'Rscripts/gcr.R', sep=""), chdir = TRUE)#
#
magND <- function(N, t_stem, t_crown, EpsS=0.9, EpsC=0.9)	{#
	# Eqn 6#
	#R_stem <- log(N) / t_stem#
	R_stem <- (1 / t_stem) * log( N * (1 - EpsS) + EpsS)#
	# Eqn 7#
	#R_crown <- (log(N) - log(2)) / t_crown#
	SQR <- N * ((N * EpsC^2) - (8 * EpsC) + (2 * N * EpsC) + N)#
	SQR <- sqrt(SQR)#
	Component <- (0.5 * N * (1 - EpsC^2)) + (2 * EpsC) +#
					(0.5 * (1 - EpsC) * SQR)#
	R_crown <- (1 / t_crown) * (log(Component) - log(2))#
	return(c(rstem=R_stem, rcrown=R_crown))#
}#
#
getAge <- function(tips, edata, Age=NULL)	{#
	if (length(tips) > 1)	{#
		maxT <- max(edata$end)#
		Node <- findMRCA(as.phylo(edata), tips, type="node")#
		Edge <- which(edata$edge[,2] == Node)#
		crownAge <- maxT - edata$end[Edge]#
		if (is.null(Age))	{#
			stemAge <- maxT - edata$begin[Edge]#
			gcr_stem <- gcr(edata, node=Node, drop.stem=F)#
			gcr_ND <- mean(gcr_stem$lambda - gcr_stem$mu)#
			EPS <- mean(gcr_stem$mu / gcr_stem$lambda)#
		}#
		if (!is.null(Age))	{#
			stemAge <- maxT - Age#
			# distance from each edge's start to the age#
			EdgeVec <- abs(edata$begin - (maxT - Age))#
			# the two edges that begin closest to the age#
			ancEdge <- which(EdgeVec == min(EdgeVec))#
#
			# nodes that descend from these edges#
			descNodes <- edata$edge[ancEdge,2]#
			if (length(descNodes) > 2)	{#
				cat("Something went wrong with: ", Age, "\n")#
			}#
			# descendent tips#
			descTips <- sapply(descNodes, function(x) edata$tip.label[getDesc(edata, x)$desc_set])#
			# correct node#
			Node <- descNodes[c(tips[1] %in% descTips[[1]], tips[1] %in% descTips[[2]])]#
			gcr_stem <- gcr(edata, node=Node, drop.stem=F)#
			gcr_ND <- mean(gcr_stem$lambda - gcr_stem$mu)#
			EPS <- mean(gcr_stem$mu / gcr_stem$lambda)#
		}#
		gcr_crown <- gcr(edata, node=Node, drop.stem=T)#
		gcr_NDc <- mean(gcr_crown$lambda - gcr_crown$mu)#
		EPSc <- mean(gcr_crown$mu / gcr_crown$lambda)#
		return(c(stem=stemAge, crown=crownAge, gcr_stem=gcr_ND, #
				gcr_crown=gcr_NDc, epsilon_stem=EPS, epsilon_crown=EPSc))#
	}#
	else	{#
		return(c(stem=NA, crown=NA, gcr_stem=NA, gcr_crown=NA, #
				epsilon_stem=NA, epsilon_crown=NA))#
	}#
}#
#
# Extant-only data#
setwd(paste(Path_base, "bamm/extant_only", sep=""))#
#
# Read in files#
exTree <- ladderize(read.tree("modernSal.tre"), right=F)#
exMCMC <- read.csv("ex_mcmc_out.txt", stringsAsFactors=F)#
exEdata <- getEventData(exTree, "ex_event_data.txt", burnin=0.5)#
exSampling <- read.table("extant_sampling.txt", #
				stringsAsFactors=F, header=F, sep="\t", skip=1)#
#
# Generate species-clade-sampling matrix#
exSpecies <- apply(exSampling, 1, function(x) unlist(strsplit(x, split=" ")))#
#
# Number of species per family#
exFams <- tapply(exSpecies[1,], exSpecies[2,], function(x) return(x))#
exobsFamN <- sapply(exFams, length)#
exFrac <- as.numeric(tapply(exSpecies[3,], exSpecies[2,], function(x) unique(x)))#
exN <- exobsFamN / exFrac#
#
# Extant-no pleth data#
# Read in files#
setwd(paste(Path_base, "bamm/extant_only", sep=""))#
npTree <- ladderize(read.tree("no_pleth.tre"), right=F)#
npMCMC <- read.csv("np_mcmc_out.txt", stringsAsFactors=F)#
npEdata <- getEventData(npTree, "np_event_data.txt", burnin=0.5)#
npSampling <- read.table("no_pleth_sampling.txt", #
				stringsAsFactors=F, header=F, sep="\t", skip=1)#
#
# Generate species-clade matrix#
npSpecies <- apply(npSampling, 1, function(x) unlist(strsplit(x, split=" ")))#
#
# Number of species per family#
npFams <- tapply(npSpecies[1,], npSpecies[2,], function(x) return(x))#
npobsFamN <- sapply(npFams, length)#
npFrac <- as.numeric(tapply(npSpecies[3,], npSpecies[2,], function(x) unique(x)))#
npN <- npobsFamN / npFrac#
#
# fossilBAMM runs#
### Post-generation addition of files#
fbEdata <- list()#
fbEdata_all <- list()#
llES <- c()#
nsES <- c()#
#
for (count in 1:70)	{#
	setwd(paste(Path_base, "bamm/output-", count, sep=""))#
	fbTree <- ladderize(read.tree("fossilTree.tre"), right=F)#
	MCMC_dat <- read.csv("base_mcmc_out.txt")#
	MCMC_dat <- MCMC_dat[floor(0.1*nrow(MCMC_dat)):nrow(MCMC_dat),]#
	fbEdata[[count]] <- getEventData(fbTree, "base_event_data.txt", #
									burnin=0.1, nsamples=200)#
	llES[count] <- effectiveSize(MCMC_dat$logLik)#
	nsES[count] <- effectiveSize(MCMC_dat$N_shifts)#
	fullTree <- ladderize(read.tree("fullTree.tre"), right=F)#
	fbEdata_all[[count]] <- getEventData(fullTree, "full_event_data.txt", #
									burnin=0.1, nsamples=200)#
}#
### Calculate net diversification#
# yes pleth, extant-only#
exAges <- sapply(exFams, function(x) getAge(x, exEdata))#
exData <- rbind(exAges, exN)#
ex_ND_mag <- apply(exData, 2, function(x) #
			magND(N=x[7], t_stem=x[1], t_crown=x[2], EpsS=x[5], EpsC=x[6]))#
exAll <- rbind(exData, ex_ND_mag)#
#
# no pleth, extant-only#
npAges <- sapply(npFams, function(x) getAge(x, npEdata))#
npData <- rbind(npAges, npN)#
np_ND_mag <- apply(npData, 2, function(x) #
			magND(N=x[7], t_stem=x[1], t_crown=x[2], EpsS=x[5], EpsC=x[6]))#
npAll <- rbind(npData, np_ND_mag)#
#
# yes pleth, fossil tree#
fAll <- list()#
for (count in 1:70)	{#
	fEdata <- fbEdata_all[[count]]#
	fAges <- sapply(1:length(exFams), function(x) getAge(exFams[[x]], fEdata, Age=exAges[1,x]))#
	fData <- rbind(fAges, exN)#
	f_ND_mag <- apply(fData, 2, function(x) #
			magND(N=x[7], t_stem=x[1], t_crown=x[2], EpsS=x[5], EpsC=x[6]))#
	fAll[[count]] <- rbind(fData, f_ND_mag)#
}#
fStems <- sapply(fnpAll, function(x) x["gcr_stem",])#
fCrown <- sapply(fnpAll, function(x) x["gcr_crown",])#
#
# no pleth, fossil tree#
fnpAll <- list()#
for (count in 1:70)	{#
	fnpEdata <- fbEdata[[count]]#
	fnpAges <- sapply(1:length(npFams), function(x) getAge(npFams[[x]], fnpEdata, Age=npAges[1,x]))#
	fnpData <- rbind(fnpAges, npN)#
	fnp_ND_mag <- apply(fnpData, 2, function(x) #
			magND(N=x[7], t_stem=x[1], t_crown=x[2], EpsS=x[5], EpsC=x[6]))#
	fnpAll[[count]] <- rbind(fnpData, fnp_ND_mag)#
}#
fnpStems <- sapply(fnpAll, function(x) x["gcr_stem",])#
fnpCrown <- sapply(fnpAll, function(x) x["gcr_crown",])#
#
makePlot <- function(x, y, Lims=c(-0.02, 0.1), Fit=T, cex=1.25, xLab="", yLab="", Linex=2, Liney=2.5)	{#
	plot(1, 1, xlim=Lims, ylim=Lims, axes=F, xlab="", ylab="", type="n")#
	axis(1, at=c(-100, pretty(Lims)))#
	axis(2, at=c(-100, pretty(Lims)))#
	segments(Lims[1], Lims[1], Lims[2], Lims[2], lty=2)#
	if (Fit)	{#
		Model <- lm(y~x)#
		segments(0, Model$coefficients[1], #
				max(x, na.rm=T), Model$coefficients[2]*max(x, na.rm=T))#
	}#
	points(x, y, pch=21, bg='gray80', cex=cex)#
	legend("top", bty="n", #
	legend=paste("r = ", round(cor(x, y, use="complete", method="pearson"), digits=2), sep=""))#
	mtext(xLab, side=1, line=Linex)#
	mtext(yLab, side=2, line=Liney, las=0)#
#
}#
par(mfrow=c(2, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), fAll["rstem.stem",], xLab="fossil stem rate", yLab="stem rate--calc.")#
makePlot(apply(fStems, 1, mean), fAll["gcr_stem",], xLab="fossil stem rate", yLab="stem rate--BAMM")#
makePlot(apply(fCrown, 1, mean), fAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate--calc.")#
makePlot(apply(fCrown, 1, mean), fAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate--BAMM")#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate--calc.")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate--BAMM")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate--calc.")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate--BAMM")
fStems <- sapply(fAll, function(x) x["gcr_stem",])#
fCrown <- sapply(fAll, function(x) x["gcr_crown",])
par(mfrow=c(2, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), fAll["rstem.stem",], xLab="fossil stem rate", yLab="stem rate - calc.")#
makePlot(apply(fStems, 1, mean), fAll["gcr_stem",], xLab="fossil stem rate", yLab="stem rate - BAMM")#
makePlot(apply(fCrown, 1, mean), fAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fCrown, 1, mean), fAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")
par(mfrow=c(2, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem.stem",], xLab="fossil stem rate", yLab="stem rate - calc.")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="fossil stem rate", yLab="stem rate - BAMM")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")
options(scipen=6)
makePlot <- function(x, y, Lims=c(-0.02, 0.1), Fit=T, cex=1.25, xLab="", yLab="", Linex=2, Liney=2.5)	{#
	plot(1, 1, xlim=Lims, ylim=Lims, axes=F, xlab="", ylab="", type="n")#
	axis(1, at=c(-100, pretty(Lims)))#
	axis(2, at=c(-100, pretty(Lims)))#
	segments(Lims[1], Lims[1], Lims[2], Lims[2], lty=2)#
	if (Fit)	{#
		Model <- lm(y~x)#
		segments(0, Model$coefficients[1], #
				max(x, na.rm=T), Model$coefficients[2]*max(x, na.rm=T))#
	}#
	points(x, y, pch=21, bg='gray80', cex=cex)#
	legend("top", bty="n", #
	legend=paste("r = ", round(cor(x, y, use="complete", method="pearson"), digits=2), sep=""))#
	mtext(xLab, side=1, line=Linex)#
	mtext(yLab, side=2, line=Liney, las=0)#
#
}#
par(mfrow=c(2, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem.stem",], xLab="fossil stem rate", yLab="stem rate - calc.")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="fossil stem rate", yLab="stem rate - BAMM")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")
pdf(paste(Path_base, "figures/netdiv_comp.pdf", sep=""), height=10, width=20)#
par(mfrow=c(2, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem.stem",], xLab="fossil stem rate", yLab="stem rate - calc.")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="fossil stem rate", yLab="stem rate - BAMM")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
dev.off()
pdf(paste(Path_base, "figures/netdiv_comp.pdf", sep=""), height=5, width=10)#
par(mfrow=c(2, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem.stem",], xLab="fossil stem rate", yLab="stem rate - calc.")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="fossil stem rate", yLab="stem rate - BAMM")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
dev.off()
pdf(paste(Path_base, "figures/netdiv_comp.pdf", sep=""), height=5, width=10)#
par(mfrow=c(2, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
dev.off()
pdf(paste(Path_base, "figures/netdiv_comp_all.pdf", sep=""), height=2.5, width=5)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
dev.off()#
#
pdf(paste(Path_base, "figures/netdiv_comp_no_pleth.pdf", sep=""), height=2.5, width=5)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
dev.off()
pdf(paste(Path_base, "figures/netdiv_comp_all.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
dev.off()#
#
pdf(paste(Path_base, "figures/netdiv_comp_no_pleth.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="fossil stem BAMM", yLab="stem rate - calc.")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="fossil stem BAMM", yLab="stem rate - BAMM")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="fossil crown BAMM", yLab="crown rate - calc.")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="fossil crown BAMM", yLab="crown rate - BAMM")#
dev.off()
source('~/Documents/BAMMtools_Functions/addScale.R', chdir = TRUE)
rttPoly <- function(RTT, opt="lam", cPoly="gray70", cLine='black', Lty=2, Lwd=2)		{#
	Times <- max(RTT$times) - RTT$times#
#
	if (opt == "lam")	{#
		Mean <- apply(RTT$lambda, 2, mean)#
		SD <- apply(RTT$lambda, 2, sd)#
	}#
	if (opt == "mu")	{#
		Mean <- apply(RTT$mu, 2, mean)#
		SD <- apply(RTT$mu, 2, sd)#
	}#
	if (opt == "net")	{#
		Vec <- RTT$lambda - RTT$mu#
		Mean <- apply(Vec, 2, mean)#
		SD <- apply(Vec, 2, sd)#
	}#
#
	Xvec <- c(Times[1], Times, Times[length(Times)], rev(Times))#
	Yvec <- c(Mean[1], Mean - 2*SD, Mean[length(Mean)], rev(Mean + 2*SD))#
	polygon(Xvec, Yvec, border=F, col=cPoly)#
	lines(Times, Mean, col=cLine, lty=Lty, lwd=Lwd)#
}#
#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n")
exRTT <- getRateThroughTimeMatrix(exEdata)
rttPoly <- function(RTT, opt="lam", cPoly="gray70", cLine='black', Lty=2, Lwd=2)		{#
	Times <- max(RTT$times) - RTT$times#
#
	if (opt == "lam")	{#
		Mean <- apply(RTT$lambda, 2, mean)#
		SD <- apply(RTT$lambda, 2, sd)#
	}#
	if (opt == "mu")	{#
		Mean <- apply(RTT$mu, 2, mean)#
		SD <- apply(RTT$mu, 2, sd)#
	}#
	if (opt == "net")	{#
		Vec <- RTT$lambda - RTT$mu#
		Mean <- apply(Vec, 2, mean)#
		SD <- apply(Vec, 2, sd)#
	}#
#
	Xvec <- c(Times[1], Times, Times[length(Times)], rev(Times))#
	Yvec <- c(Mean[1], Mean - 2*SD, Mean[length(Mean)], rev(Mean + 2*SD))#
	polygon(Xvec, Yvec, border=F, col=cPoly)#
	lines(Times, Mean, col=cLine, lty=Lty, lwd=Lwd)#
}#
#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")
rttPoly(exRTT, opt="net")
exRTT <- getRateThroughTimeMatrix(exEdata)#
npRTT <- getRateThroughTimeMatrix(npEdata)#
fnpRTT <- getRateThroughTimeMatrix(fbEdata[[1]])
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="net", cPoly=rgb(1,0,0,0.5))
rttPoly(npRTT, opt="net", cPoly=rgb(0,0,1,0.5))
rttPoly <- function(RTT, opt="lam", cPoly="gray70", cLine='black', Lty=2, Lwd=2)		{#
	Times <- max(RTT$times) - RTT$times#
#
	if (opt == "lam")	{#
		Mean <- apply(RTT$lambda, 2, mean)#
		SD <- apply(RTT$lambda, 2, sd)#
	}#
	if (opt == "mu")	{#
		Mean <- apply(RTT$mu, 2, mean)#
		SD <- apply(RTT$mu, 2, sd)#
	}#
	if (opt == "net")	{#
		Vec <- RTT$lambda - RTT$mu#
		Mean <- apply(Vec, 2, mean)#
		SD <- apply(Vec, 2, sd)#
	}#
	if (opt == "rel")	{#
		Vec <- RTT$mu / RTT$lambda#
		Mean <- apply(Vec, 2, mean)#
		SD <- apply(Vec, 2, sd)#
	}#
	Xvec <- c(Times[1], Times, Times[length(Times)], rev(Times))#
	Yvec <- c(Mean[1], Mean - 2*SD, Mean[length(Mean)], rev(Mean + 2*SD))#
	polygon(Xvec, Yvec, border=F, col=cPoly)#
	lines(Times, Mean, col=cLine, lty=Lty, lwd=Lwd)#
}#
#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="rel", cPoly=rgb(1,0,0,0.5))#
rttPoly(npRTT, opt="rel", cPoly=rgb(0,0,1,0.5))
rttPoly <- function(RTT, opt="lam", cPoly="gray70", cLine='black', Lty=2, Lwd=2)		{#
	Times <- max(RTT$times) - RTT$times#
#
	if (opt == "lam")	{#
		Mean <- apply(RTT$lambda, 2, mean)#
		SD <- apply(RTT$lambda, 2, sd)#
	}#
	if (opt == "mu")	{#
		Mean <- apply(RTT$mu, 2, mean)#
		SD <- apply(RTT$mu, 2, sd)#
	}#
	if (opt == "net")	{#
		Vec <- RTT$lambda - RTT$mu#
		Mean <- apply(Vec, 2, mean)#
		SD <- apply(Vec, 2, sd)#
	}#
	if (opt == "rel")	{#
		Vec <- RTT$mu / RTT$lambda#
		Mean <- apply(Vec, 2, mean)#
		SD <- apply(Vec, 2, sd)#
	}#
	Xvec <- c(Times[1], Times, Times[length(Times)], rev(Times))#
	Yvec <- c(Mean[1], Mean - 2*SD, Mean[length(Mean)], rev(Mean + 2*SD))#
	polygon(Xvec, Yvec, border=F, col=cPoly)#
	lines(Times, Mean, col=cLine, lty=Lty, lwd=Lwd)#
}#
#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="rel", cPoly=rgb(1,0,0,0.5))#
rttPoly(npRTT, opt="rel", cPoly=rgb(0,0,1,0.5))
rttPoly <- function(RTT, opt="lam", cPoly="gray70", cLine='black', Lty=2, Lwd=2)		{#
	Times <- max(RTT$times) - RTT$times#
#
	if (opt == "lam")	{#
		Mean <- apply(RTT$lambda, 2, mean)#
		Lo <- apply(Vec, 2, quantile, probs=0.05)#
		Hi <- apply(Vec, 2, quantile, probs=0.95)#
	}#
	if (opt == "mu")	{#
		Mean <- apply(RTT$mu, 2, mean)#
		Lo <- apply(Vec, 2, quantile, probs=0.05)#
		Hi <- apply(Vec, 2, quantile, probs=0.95)#
	}#
	if (opt == "net")	{#
		Vec <- RTT$lambda - RTT$mu#
		Mean <- apply(Vec, 2, mean)#
		Lo <- apply(Vec, 2, quantile, probs=0.05)#
		Hi <- apply(Vec, 2, quantile, probs=0.95)#
	}#
	if (opt == "rel")	{#
		Vec <- RTT$mu / RTT$lambda#
		Mean <- apply(Vec, 2, mean)#
		Lo <- apply(Vec, 2, quantile, probs=0.05)#
		Hi <- apply(Vec, 2, quantile, probs=0.95)#
	}#
	Xvec <- c(Times[1], Times, Times[length(Times)], rev(Times))#
	Yvec <- c(Mean[1], Lo, Mean[length(Mean)], rev(Hi))#
	polygon(Xvec, Yvec, border=F, col=cPoly)#
	lines(Times, Mean, col=cLine, lty=Lty, lwd=Lwd)#
}#
#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="rel", cPoly=rgb(1,0,0,0.5))#
rttPoly(npRTT, opt="rel", cPoly=rgb(0,0,1,0.5))
plot(1, 1, xlim=c(225, 0), ylim=c(0, 1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5))#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5))
rttPoly <- function(RTT, opt="lam", cPoly="gray70", cLine='black', Lty=2, Lwd=2)		{#
	Times <- max(RTT$times) - RTT$times#
#
	if (opt == "lam")	{#
		Mean <- apply(RTT$lambda, 2, mean)#
		Lo <- apply(RTT$lambda, 2, quantile, probs=0.05)#
		Hi <- apply(RTT$lambda, 2, quantile, probs=0.95)#
	}#
	if (opt == "mu")	{#
		Mean <- apply(RTT$mu, 2, mean)#
		Lo <- apply(RTT$mu, 2, quantile, probs=0.05)#
		Hi <- apply(RTT$mu, 2, quantile, probs=0.95)#
	}#
	if (opt == "net")	{#
		Vec <- RTT$lambda - RTT$mu#
		Mean <- apply(Vec, 2, mean)#
		Lo <- apply(Vec, 2, quantile, probs=0.05)#
		Hi <- apply(Vec, 2, quantile, probs=0.95)#
	}#
	if (opt == "rel")	{#
		Vec <- RTT$mu / RTT$lambda#
		Mean <- apply(Vec, 2, mean)#
		Lo <- apply(Vec, 2, quantile, probs=0.05)#
		Hi <- apply(Vec, 2, quantile, probs=0.95)#
	}#
	Xvec <- c(Times[1], Times, Times[length(Times)], rev(Times))#
	Yvec <- c(Mean[1], Lo, Mean[length(Mean)], rev(Hi))#
	polygon(Xvec, Yvec, border=F, col=cPoly)#
	lines(Times, Mean, col=cLine, lty=Lty, lwd=Lwd)#
}#
#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5))#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5))
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5))#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5))
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5))#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3)
rttPoly <- function(RTT, opt="lam", cPoly="gray70", cLine='black', Lty=2, Lwd=2, LoP=0.05, HiP=0.95)		{#
	Times <- max(RTT$times) - RTT$times#
#
	if (opt == "lam")	{#
		Mean <- apply(RTT$lambda, 2, mean)#
		Lo <- apply(RTT$lambda, 2, quantile, probs=LoP)#
		Hi <- apply(RTT$lambda, 2, quantile, probs=HiP)#
	}#
	if (opt == "mu")	{#
		Mean <- apply(RTT$mu, 2, mean)#
		Lo <- apply(RTT$mu, 2, quantile, probs=LoP)#
		Hi <- apply(RTT$mu, 2, quantile, probs=HiP)#
	}#
	if (opt == "net")	{#
		Vec <- RTT$lambda - RTT$mu#
		Mean <- apply(Vec, 2, mean)#
		Lo <- apply(Vec, 2, quantile, probs=LoP)#
		Hi <- apply(Vec, 2, quantile, probs=HiP)#
	}#
	if (opt == "rel")	{#
		Vec <- RTT$mu / RTT$lambda#
		Mean <- apply(Vec, 2, mean)#
		Lo <- apply(Vec, 2, quantile, probs=LoP)#
		Hi <- apply(Vec, 2, quantile, probs=HiP)#
	}#
	Xvec <- c(Times[1], Times, Times[length(Times)], rev(Times))#
	Yvec <- c(Mean[1], Lo, Mean[length(Mean)], rev(Hi))#
	polygon(Xvec, Yvec, border=F, col=cPoly)#
	lines(Times, Mean, col=cLine, lty=Lty, lwd=Lwd)#
}#
#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), YLim=c(-10, 0.01))
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), YLim=c(-10, 0))
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))
axis(1, at=seq(from=225, to=0, by=-25))
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))
par(mar=c(4, 5, 1, 1), las=1)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 204, 250, 204), y=c(0, 0, 0.1, 0.1), border="n", col='gray90')#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 204, 250, 204), y=c(0, 0, 0.1, 0.1), border=NULL, col='gray90')#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 204, 250, 204), y=c(0, 0.1, 0, 0.1), border=NULL, col='gray90')#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 204, 250, 204), y=c(0, 0.1, 0.1, 0), border='gray90', col='gray90')#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 250, 204, 204), y=c(0, 0.1, 0.1, 0), border='gray90', col='gray90')#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 250, 204, 204), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
polygon(x=c(148, 148, 66, 66), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=rgb(1,0,0,0.5), LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=rgb(0,0,1,0.5), Lty=3, LoP=0.25, HiP=0.75)
Cols <- c(rgb(166/255, 206/255, 227/255, 1), #
		  rgb(31/255, 120/255, 180/255, 1), #
		  rgb(178/255, 223/25, 138/255, 1), #
		  rgb(51/255, 160/255, 44/255, 1), #
		  rgb(251/255, 154/255, 153/255, 1))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[2], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[4], Lty=3, LoP=0.25, HiP=0.75)
Cols <- c(rgb(166/255, 206/255, 227/255, 1), #
		  rgb(31/255, 120/255, 180/255, 1), #
		  rgb(178/255, 223/255, 138/255, 1), #
		  rgb(51/255, 160/255, 44/255, 1), #
		  rgb(251/255, 154/255, 153/255, 1))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[2], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[4], Lty=3, LoP=0.25, HiP=0.75)
Cols <- c(rgb(166/255, 206/255, 227/255, 1), #
		  rgb(31/255, 120/255, 180/255, 1), #
		  rgb(178/255, 223/255, 138/255, 1), #
		  rgb(51/255, 160/255, 44/255, 1), #
		  rgb(251/255, 154/255, 153/255, 1))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.1))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)
Cols <- c(rgb(166/255, 206/255, 227/255, 1), #
		  rgb(31/255, 120/255, 180/255, 1), #
		  rgb(178/255, 223/255, 138/255, 1), #
		  rgb(51/255, 160/255, 44/255, 1), #
		  rgb(251/255, 154/255, 153/255, 1))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.1, 0.1, 0), border=rgb(0, 0, 0, 0.1), col=rgb(0, 0, 0, 0.05))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)
Cols <- c(rgb(166/255, 206/255, 227/255, 1), #
		  rgb(31/255, 120/255, 180/255, 1), #
		  rgb(178/255, 223/255, 138/255, 1), #
		  rgb(51/255, 160/255, 44/255, 1), #
		  rgb(251/255, 154/255, 153/255, 1))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=NA, col=rgb(0, 0, 0, 0.05))
Cols <- c(rgb(166/255, 206/255, 227/255, 1), #
		  rgb(31/255, 120/255, 180/255, 1), #
		  rgb(178/255, 223/255, 138/255, 1), #
		  rgb(51/255, 160/255, 44/255, 1), #
		  rgb(251/255, 154/255, 153/255, 1))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.1, 0.1, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)
Cols <- c(rgb(166/255, 206/255, 227/255, 1), #
		  rgb(31/255, 120/255, 180/255, 1), #
		  rgb(178/255, 223/255, 138/255, 1), #
		  rgb(51/255, 160/255, 44/255, 1), #
		  rgb(251/255, 154/255, 153/255, 1))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.1, 0.1, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)
Cols <- c(rgb(166/255, 206/255, 227/255, 1), #
		  rgb(31/255, 120/255, 180/255, 1), #
		  rgb(178/255, 223/255, 138/255, 1), #
		  rgb(51/255, 160/255, 44/255, 1), #
		  rgb(251/255, 154/255, 153/255, 1))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.1, 0.1, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.1, 0.1, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)
Cols <- c(rgb(166/255, 206/255, 227/255, 1), #
		  rgb(31/255, 120/255, 180/255, 1), #
		  rgb(178/255, 223/255, 138/255, 1), #
		  rgb(51/255, 160/255, 44/255, 1), #
		  rgb(251/255, 154/255, 153/255, 1))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)
par(mfrow=c(1,2))
plot(npEdata)
?plot.bammdata
plot(fbEdata[[1]], direction="leftwards")
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e")#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards")
par(mfrow=c(1,2), mar=c(0,0,0,0))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e")#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards")
par(mfrow=c(1,2), mar=c(0,0,0,0))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
par(mfrow=c(1,2), mar=c(0,0,0,3))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,3,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
par(mfrow=c(1,2), mar=c(0,0,0,1))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
par(mfrow=c(1,3), mar=c(0,0,0,1.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)
par(mfrow=c(1,3), mar=c(0,0,0,1.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)
par(mfrow=c(1, 3), mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
rttPoly <- function(RTT, opt="lam", cPoly="gray70", cLine='black', Lty=2, Lwd=2, LoP=0.05, HiP=0.95)		{#
	Times <- max(RTT$times) - RTT$times#
#
	if (opt == "lam")	{#
		Mean <- apply(RTT$lambda, 2, median)#
		Lo <- apply(RTT$lambda, 2, quantile, probs=LoP)#
		Hi <- apply(RTT$lambda, 2, quantile, probs=HiP)#
	}#
	if (opt == "mu")	{#
		Mean <- apply(RTT$mu, 2, median)#
		Lo <- apply(RTT$mu, 2, quantile, probs=LoP)#
		Hi <- apply(RTT$mu, 2, quantile, probs=HiP)#
	}#
	if (opt == "net")	{#
		Vec <- RTT$lambda - RTT$mu#
		Mean <- apply(Vec, 2, median)#
		Lo <- apply(Vec, 2, quantile, probs=LoP)#
		Hi <- apply(Vec, 2, quantile, probs=HiP)#
	}#
	if (opt == "rel")	{#
		Vec <- RTT$mu / RTT$lambda#
		Mean <- apply(Vec, 2, mean)#
		Lo <- apply(Vec, 2, quantile, probs=LoP)#
		Hi <- apply(Vec, 2, quantile, probs=HiP)#
	}#
	Xvec <- c(Times[1], Times, Times[length(Times)], rev(Times))#
	Yvec <- c(Mean[1], Lo, Mean[length(Mean)], rev(Hi))#
	polygon(Xvec, Yvec, border=F, col=cPoly)#
	lines(Times, Mean, col=cLine, lty=Lty, lwd=Lwd)#
}#
#
Cols <- c(rgb(166/255, 206/255, 227/255, 1), #
		  rgb(31/255, 120/255, 180/255, 1), #
		  rgb(178/255, 223/255, 138/255, 1), #
		  rgb(51/255, 160/255, 44/255, 1), #
		  rgb(251/255, 154/255, 153/255, 1))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)#
par(mfrow=c(1, 3), mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
par(mfrow=c(1, 3), mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
par(mfrow=c(1, 3), mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
par(mfrow=c(1, 3), mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
?layout
layout(widths=c(1,2,2))#
par(mfrow=c(1, 3), mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
layout(mat=matrix(c(1, 1, 1), byrow=T, nrow=1), widths=c(1,2,2))
par(mfrow=c(1, 3), mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
layout(mat=matrix(c(1, 1, 1), byrow=T, nrow=1), widths=c(1,2,2))#
par(mar=c(4, 5, 1, 1), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
#rttPoly(exRTT, opt="net")#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[3], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mfrow=c(1, 3), mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
layout(mat=matrix(c(1, 1, 1), byrow=T, nrow=1), widths=c(1,2,2))#
par(mfrow=c(1, 3), mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
matrix(c(1, 1, 1), byrow=T, nrow=1)
help(layout)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,2,2))#
par(mfrow=c(1, 3), mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5))#
par(mfrow=c(1, 3), mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5))
par(mfrow=c(1, 3), mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(1))
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(1))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=2.5, width=5)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.5, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=3, width=6)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=4, width=8)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2)#
mtext("extinction rate", side=2, line=3, las=0)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=4, width=8)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()
Cols <- c('gray70', 'gray80', 'gray90',#
		  'gray60', 'gray40')#
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=4, width=8)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()
Cols <- c('gray70', 'gray80', 'gray90',#
		  'gray60', 'gray60')#
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=4, width=8)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=4, width=8)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=4, width=8)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)
addBAMMlegend(P, location="topleft")
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=4, width=8)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft")#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()#
#
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=4, width=8)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft")#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft")#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft")#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()#
#
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft")#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.6)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()#
#
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
?addBAMMlegend
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()#
#
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/netdiv_comp_all.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem.stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - calc.")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="stem rate - fossilBAMM", yLab="stem rate - BAMM")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown.crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - calc.")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - BAMM")#
dev.off()#
#
pdf(paste(Path_base, "figures/netdiv_comp_no_pleth.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - calc.")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - BAMM")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - calc.")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - BAMM")#
dev.off()
library(png)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))
addBAMMlegend
par("usr")
points(-8.5, 233)
points(-9.5, 247)
tiplabels
plotSil <- function(TipTax, xoffset, yoffset, Tree, Hpad=0, Vpad=0, Image=NULL, Download=TRUE, Address=NULL)	{#
	require(png)#
	lastPP <- get("last_plot.phylo", envir = .PlotPhyloEnv)#
	if (Download == TRUE)	{#
		if (is.null(Address))	{#
			stop("need to supply a web address if Download == TRUE")#
		}#
		picFile <- download.file(Address, dest=paste(TipTax, ".png", sep=""), mode="wb")#
	}#
	if (is.null(Image))	{#
		plotPic <- readPNG(paste(TipTax, ".png", sep=""))#
	}#
	tip <- which(Tree$tip.label==TipTax)#
	xloc <- lastPP$xx[tip] + Hpad#
	yloc <- lastPP$yy[tip] + Vpad#
#
	rasterImage(plotPic, xloc-xoffset, yloc-yoffset, xloc+xoffset, yloc+yoffset, xpd=NA)#
}
plotSil("Notophthalmus_viridens", 0, 0, fbEdata[[1]], Image=Image)
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridens", 0, 0, fbEdata[[1]], Image=Image, Download=F)
plotSil <- function(TipTax, xoffset, yoffset, Tree, Hpad=0, Vpad=0, plotPic=NULL, Download=TRUE, Address=NULL)	{#
	require(png)#
	lastPP <- get("last_plot.phylo", envir = .PlotPhyloEnv)#
	if (Download == TRUE)	{#
		if (is.null(Address))	{#
			stop("need to supply a web address if Download == TRUE")#
		}#
		picFile <- download.file(Address, dest=paste(TipTax, ".png", sep=""), mode="wb")#
	}#
	if (is.null(plotPic))	{#
		plotPic <- readPNG(paste(TipTax, ".png", sep=""))#
	}#
	tip <- which(Tree$tip.label==TipTax)#
	xloc <- lastPP$xx[tip] + Hpad#
	yloc <- lastPP$yy[tip] + Vpad#
#
	rasterImage(plotPic, xloc-xoffset, yloc-yoffset, xloc+xoffset, yloc+yoffset, xpd=NA)#
}
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridens", 0, 0, fbEdata[[1]], Image=Image, Download=F)
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridens", 0, 0, fbEdata[[1]], plotPic=Image, Download=F)
grep("Notoph", fbEdata[[1]]$tip.label)
fbEdata[[1]]$tip.label[150]
fbEdata[[1]]$tip.label[151]
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridescens", 0, 0, fbEdata[[1]], Image=Image, Download=F)
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridescens", 0, 0, fbEdata[[1]], plotPic=Image, Download=F)
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridescens", -1, -1, fbEdata[[1]], plotPic=Image, Download=F)
TipTax <- "Notophthalmus_viridescens"
tree <- fbEdata[[1]]
plotPic <- Image
lastPP <- get("last_plot.phylo", envir = .PlotPhyloEnv)
lastPP
tip <- which(Tree$tip.label==TipTax)
Tree <- tree
tip <- which(Tree$tip.label==TipTax)
tip
xloc <- lastPP$xx[tip] + Hpad
Hpad <- 0
xloc <- lastPP$xx[tip] + Hpad
Vpad <- 0
yloc <- lastPP$yy[tip] + Vpad
plot(xloc, yloc)
xloc
yloc
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)
plotSil("Notophthalmus_viridescens", 1, 1, fbEdata[[1]], plotPic=Image, Download=F)
points(xloc, yloc)
plotSil("Notophthalmus_viridescens", 5, 1, fbEdata[[1]], plotPic=Image, Download=F)
rasterImage(Image, xloc-1, yloc-1, xloc+1, yloc+1)
rasterImage(Image, xloc-10, yloc-10, xloc+10, yloc+10)
plotSil("Notophthalmus_viridescens", 20, 20, fbEdata[[1]], plotPic=Image, Download=F)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)
plotSil("Notophthalmus_viridescens", xoffset=20, yoffset=10, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=10, Download=F)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)
plotSil("Notophthalmus_viridescens", xoffset=20, yoffset=8, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)
plotSil("Notophthalmus_viridescens", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
Image <- readPNG(paste(Path_base, "figures/images/ambystoma.png", sep=""))#
plotSil("Ambystoma_maculatum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
plotSil("Ambystoma_tigrinum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
plotSil("Ambystoma_opacum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
plotSil("Ambystoma_mexicanum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
Image <- readPNG(paste(Path_base, "figures/images/siren.png", sep=""))#
plotSil("Siren_lacertina", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
Tree$tip.label[grep("Crypto", Tree$tip.label)]
Image <- readPNG(paste(Path_base, "figures/images/hellbender.png", sep=""))#
plotSil("Cryptobranchus_alleganiensis", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridescens", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/ambystoma.png", sep=""))#
plotSil("Ambystoma_tigrinum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/siren.png", sep=""))#
plotSil("Siren_lacertina", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/hellbender.png", sep=""))#
plotSil("Cryptobranchus_alleganiensis", xoffset=20, yoffset=4, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridescens", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/ambystoma.png", sep=""))#
plotSil("Ambystoma_tigrinum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/siren.png", sep=""))#
plotSil("Siren_lacertina", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/hellbender.png", sep=""))#
plotSil("Cryptobranchus_alleganiensis", xoffset=20, yoffset=10, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridescens", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/ambystoma.png", sep=""))#
plotSil("Ambystoma_tigrinum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/siren.png", sep=""))#
plotSil("Siren_lacertina", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/hellbender.png", sep=""))#
plotSil("Cryptobranchus_alleganiensis", xoffset=20, yoffset=2, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)#
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridescens", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/ambystoma.png", sep=""))#
plotSil("Ambystoma_tigrinum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/siren.png", sep=""))#
plotSil("Siren_lacertina", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/hellbender.png", sep=""))#
plotSil("Cryptobranchus_alleganiensis", xoffset=20, yoffset=2, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)
makePlot <- function(x, y, Lims=c(-0.02, 0.1), Fit=T, cex=1.25, xLab="", yLab="", Linex=2, Liney=2.5, Label="")	{#
	plot(1, 1, xlim=Lims, ylim=Lims, axes=F, xlab="", ylab="", type="n")#
	axis(1, at=c(-100, pretty(Lims)))#
	axis(2, at=c(-100, pretty(Lims)))#
	segments(Lims[1], Lims[1], Lims[2], Lims[2], lty=2)#
	if (Fit)	{#
		Model <- lm(y~x)#
		segments(0, Model$coefficients[1], #
				max(x, na.rm=T), Model$coefficients[2]*max(x, na.rm=T))#
	}#
	points(x, y, pch=21, bg='gray80', cex=cex)#
	legend("top", bty="n", #
	legend=paste("r = ", round(cor(x, y, use="complete", method="pearson"), digits=2), sep=""))#
	mtext(xLab, side=1, line=Linex)#
	mtext(yLab, side=2, line=Liney, las=0)#
	mtext(Label, side=2, line=2, at=Lims[2])#
}#
#
pdf(paste(Path_base, "figures/netdiv_comp_all.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem.stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - calc.", Label="A")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="stem rate - fossilBAMM", yLab="stem rate - BAMM", Label="B")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown.crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - calc.", Label="C")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - BAMM", Label="D")#
dev.off()
makePlot <- function(x, y, Lims=c(-0.02, 0.1), Fit=T, cex=1.25, xLab="", yLab="", Linex=2, Liney=2.5, Label="")	{#
	plot(1, 1, xlim=Lims, ylim=Lims, axes=F, xlab="", ylab="", type="n")#
	axis(1, at=c(-100, pretty(Lims)))#
	axis(2, at=c(-100, pretty(Lims)))#
	segments(Lims[1], Lims[1], Lims[2], Lims[2], lty=2)#
	if (Fit)	{#
		Model <- lm(y~x)#
		segments(0, Model$coefficients[1], #
				max(x, na.rm=T), Model$coefficients[2]*max(x, na.rm=T))#
	}#
	points(x, y, pch=21, bg='gray80', cex=cex)#
	legend("top", bty="n", #
	legend=paste("r = ", round(cor(x, y, use="complete", method="pearson"), digits=2), sep=""))#
	mtext(xLab, side=1, line=Linex)#
	mtext(yLab, side=2, line=Liney, las=0)#
	mtext(Label, side=2, line=3, at=Lims[2])#
}#
#
pdf(paste(Path_base, "figures/netdiv_comp_all.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem.stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - calc.", Label="A")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="stem rate - fossilBAMM", yLab="stem rate - BAMM", Label="B")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown.crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - calc.", Label="C")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - BAMM", Label="D")#
dev.off()
pdf(paste(Path_base, "figures/netdiv_comp_no_pleth.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fnpStems, 1, mean), npAll["rstem.stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - calc.", Label="A")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - BAMM", Label="B")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown.crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - calc.", Label="C")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - BAMM", Label="D")#
dev.off()
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.06, line=3)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.06, line=3)#
mtext("B", side=2, at=0.06, line=-10, xpd=NA)
mtext("B", side=2, at=0.06, line=-50, xpd=NA)
mtext("B", side=2, at=0.06, line=-20, xpd=NA)
mtext("B", side=2, at=0.06, line=-25, xpd=NA)
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.06, line=3)#
mtext("B", side=2, at=0.06, line=-22, xpd=NA)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.06, line=3)#
mtext("B", side=2, at=0.06, line=-22, xpd=NA)#
mtext("C", side=2, at=0.06, line=-32, xpd=NA)
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.06, line=3)#
mtext("B", side=2, at=0.06, line=-22, xpd=NA)#
mtext("C", side=2, at=0.06, line=-38, xpd=NA)
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.06, line=3)#
mtext("B", side=2, at=0.06, line=-22, xpd=NA)#
#mtext("C", side=2, at=0.06, line=-38, xpd=NA)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()#
#
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.1, line=3)#
mtext("B", side=2, at=0.1, line=-22, xpd=NA)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)#
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridescens", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/ambystoma.png", sep=""))#
plotSil("Ambystoma_tigrinum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/siren.png", sep=""))#
plotSil("Siren_lacertina", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/hellbender.png", sep=""))#
plotSil("Cryptobranchus_alleganiensis", xoffset=20, yoffset=2, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.06, line=3)#
mtext("B", side=2, at=0.06, line=-21, xpd=NA)#
#mtext("C", side=2, at=0.06, line=-38, xpd=NA)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()#
#
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.1, line=3)#
mtext("B", side=2, at=0.1, line=-21, xpd=NA)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)#
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridescens", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/ambystoma.png", sep=""))#
plotSil("Ambystoma_tigrinum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/siren.png", sep=""))#
plotSil("Siren_lacertina", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/hellbender.png", sep=""))#
plotSil("Cryptobranchus_alleganiensis", xoffset=20, yoffset=2, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
pdf(paste(Path_base, "figures/ExtRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.06), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.01, 0.02, 0.03, 0.04, 0.05, 0.06))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("extinction rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.06, line=3)#
mtext("B", side=2, at=0.06, line=-21.5, xpd=NA)#
#mtext("C", side=2, at=0.06, line=-38, xpd=NA)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="mu", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="mu", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="e", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="e", direction="leftwards", lwd=2)#
dev.off()#
#
pdf(paste(Path_base, "figures/SpecRate.pdf", sep=""), height=3.5, width=7)#
layout(mat=matrix(c(1, 2, 3), byrow=T, nrow=1), widths=c(1,0.5,0.5), heights=c(2))#
par(mar=c(4, 5, 0.5, 0.5), las=1, mgp=c(2, 0.3, 0), tck=-0.01)#
plot(1, 1, xlim=c(225, 0), ylim=c(0, 0.1), type="n", axes=F, bty="n", xlab="", ylab="")#
addScale(c(225, 200, 175, 150, 125, 100, 75, 50, 25, 0), units="Stage", YLim=c(-10, 0))#
axis(1, at=seq(from=250, to=0, by=-25))#
axis(2, at=c(-10, 0, 0.02, 0.04, 0.06, 0.08, 0.1))#
#
mtext("age (Ma)", side=1, line=2, cex=1.25)#
mtext("speciation rate", side=2, line=3, las=0, cex=1.25)#
mtext("A", side=2, at=0.1, line=3)#
mtext("B", side=2, at=0.1, line=-21.5, xpd=NA)#
#
#polygon(x=c(250, 250, 201, 201), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#polygon(x=c(145, 145, 66, 66), y=c(0, 0.06, 0.06, 0), border=NA, col=rgb(0, 0, 0, 0.05))#
#
rttPoly(fnpRTT, opt="lam", cPoly=Cols[1], LoP=0.25, HiP=0.75)#
rttPoly(npRTT, opt="lam", cPoly=Cols[5], Lty=3, LoP=0.25, HiP=0.75)#
#
par(mar=c(0,0,0,1.5))#
P <- plot(fbEdata[[1]], breaksmethod="jenks", spex="s", lwd=2)#
addBAMMlegend(P, location="topleft", cex.axis=0.9, labelDist=0.5, shortFrac=0.04)#
Image <- readPNG(paste(Path_base, "figures/images/newt2.png", sep=""))#
plotSil("Notophthalmus_viridescens", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/ambystoma.png", sep=""))#
plotSil("Ambystoma_tigrinum", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/siren.png", sep=""))#
plotSil("Siren_lacertina", xoffset=20, yoffset=5, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
Image <- readPNG(paste(Path_base, "figures/images/hellbender.png", sep=""))#
plotSil("Cryptobranchus_alleganiensis", xoffset=20, yoffset=2, Tree=fbEdata[[1]], plotPic=Image, Vpad=0, Hpad=30, Download=F)#
#
par(mar=c(0,1.5,0,0))#
plot(npEdata, colorbreaks=P$colorbreaks, spex="s", direction="leftwards", lwd=2)#
dev.off()
# Tip rates between fossil and extant-only species#
par(mfrow=c(2,2), mar=c(4, 5, 0.5, 0.5), bty="n", las=1, mgp=c(2, 0.5, 0), tck=-0.01, cex.axis=0.9)#
Liney <- 3#
Linex <- 2#
#
# all#
edata <- fbEdata_all[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- exEdata$meanTipLambda#
names(exSpec) <- exEdata$tip.label#
exExt <- exEdata$meanTipMu#
names(exExt) <- exEdata$tip.label#
#
Inter <- intersect(exEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="a)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], "b)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)
make.plot <- function(vec1, vec2, label=NULL, labline=3)	{#
	R <- range(c(vec1, vec2))#
	Ticks <- pretty(R)#
	plot(1, 1, type="n", xlim=range(Ticks), ylim=range(Ticks), axes=F, xlab="", ylab="")#
	points(vec1, vec2, pch=21, bg='gray70')#
	axis(1, at=c(-100, Ticks))#
	axis(2, at=c(-100, Ticks))#
	segments(Ticks[1], Ticks[1], Ticks[length(Ticks)], Ticks[length(Ticks)], lty=2)#
	if (!is.null(label))	{#
		mtext(label, side=2, at=max(Ticks), line=labline, cex=1.25)#
	}#
}#
options(scipen=6)
# Tip rates between fossil and extant-only species#
par(mfrow=c(2,2), mar=c(4, 5, 0.5, 0.5), bty="n", las=1, mgp=c(2, 0.5, 0), tck=-0.01, cex.axis=0.9)#
Liney <- 3#
Linex <- 2#
#
# all#
edata <- fbEdata_all[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- exEdata$meanTipLambda#
names(exSpec) <- exEdata$tip.label#
exExt <- exEdata$meanTipMu#
names(exExt) <- exEdata$tip.label#
#
Inter <- intersect(exEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="a)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], "b)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)
edata <- fbEdata[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- npEdata$meanTipLambda#
names(exSpec) <- npEdata$tip.label#
exExt <- npEdata$meanTipMu#
names(exExt) <- npEdata$tip.label#
#
Inter <- intersect(npEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="c)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], label="d)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)
make.plot(exSpec[Inter] - exExt[Inter], Spec[Inter] - Ext[Inter], "b)")#
mtext("net div. rate - fossils", side=2, las=0, line=Liney)#
mtext("net div. rate - extant", side=1, line=Linex)
6.5 * (3/2)
setwd(paste(Path_base, "figures", sep=""))#
pdf("rateCors.pdf", height=6.5, width=9.75)#
# Tip rates between fossil and extant-only species#
par(mfrow=c(2,3), mar=c(4, 5, 0.5, 0.5), bty="n", las=1, mgp=c(2, 0.5, 0), tck=-0.01, cex.axis=0.9)#
Liney <- 3#
Linex <- 2#
#
# all#
edata <- fbEdata_all[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- exEdata$meanTipLambda#
names(exSpec) <- exEdata$tip.label#
exExt <- exEdata$meanTipMu#
names(exExt) <- exEdata$tip.label#
#
Inter <- intersect(exEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="a)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], "b)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)#
make.plot(exSpec[Inter] - exExt[Inter], Spec[Inter] - Ext[Inter], "c)")#
mtext("net div. rate - fossils", side=2, las=0, line=Liney)#
mtext("net div. rate - extant", side=1, line=Linex)#
#
# No Pleths#
edata <- fbEdata[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- npEdata$meanTipLambda#
names(exSpec) <- npEdata$tip.label#
exExt <- npEdata$meanTipMu#
names(exExt) <- npEdata$tip.label#
#
Inter <- intersect(npEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="c)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], label="d)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)#
make.plot(exSpec[Inter] - exExt[Inter], Spec[Inter] - Ext[Inter], "c)")#
mtext("net div. rate - fossils", side=2, las=0, line=Liney)#
mtext("net div. rate - extant", side=1, line=Linex)#
#
dev.off()
9.75 / 2
6.5 / 2
setwd(paste(Path_base, "figures", sep=""))#
pdf("rateCors.pdf", height=3.25, width=4.875)#
# Tip rates between fossil and extant-only species#
par(mfrow=c(2,3), mar=c(4, 5, 0.5, 0.5), bty="n", las=1, mgp=c(2, 0.5, 0), tck=-0.01, cex.axis=0.9)#
Liney <- 3#
Linex <- 2#
#
# all#
edata <- fbEdata_all[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- exEdata$meanTipLambda#
names(exSpec) <- exEdata$tip.label#
exExt <- exEdata$meanTipMu#
names(exExt) <- exEdata$tip.label#
#
Inter <- intersect(exEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="a)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], "b)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)#
make.plot(exSpec[Inter] - exExt[Inter], Spec[Inter] - Ext[Inter], "c)")#
mtext("net div. rate - fossils", side=2, las=0, line=Liney)#
mtext("net div. rate - extant", side=1, line=Linex)#
#
# No Pleths#
edata <- fbEdata[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- npEdata$meanTipLambda#
names(exSpec) <- npEdata$tip.label#
exExt <- npEdata$meanTipMu#
names(exExt) <- npEdata$tip.label#
#
Inter <- intersect(npEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="c)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], label="d)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)#
make.plot(exSpec[Inter] - exExt[Inter], Spec[Inter] - Ext[Inter], "c)")#
mtext("net div. rate - fossils", side=2, las=0, line=Liney)#
mtext("net div. rate - extant", side=1, line=Linex)#
#
dev.off()
6.5 * (2/3)
setwd(paste(Path_base, "figures", sep=""))#
pdf("rateCors.pdf", height=4.3333, width=6.5)#
# Tip rates between fossil and extant-only species#
par(mfrow=c(2,3), mar=c(4, 5, 0.5, 0.5), bty="n", las=1, mgp=c(2, 0.5, 0), tck=-0.01, cex.axis=0.9)#
Liney <- 3#
Linex <- 2#
#
# all#
edata <- fbEdata_all[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- exEdata$meanTipLambda#
names(exSpec) <- exEdata$tip.label#
exExt <- exEdata$meanTipMu#
names(exExt) <- exEdata$tip.label#
#
Inter <- intersect(exEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="a)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], "b)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)#
make.plot(exSpec[Inter] - exExt[Inter], Spec[Inter] - Ext[Inter], "c)")#
mtext("net div. rate - fossils", side=2, las=0, line=Liney)#
mtext("net div. rate - extant", side=1, line=Linex)#
#
# No Pleths#
edata <- fbEdata[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- npEdata$meanTipLambda#
names(exSpec) <- npEdata$tip.label#
exExt <- npEdata$meanTipMu#
names(exExt) <- npEdata$tip.label#
#
Inter <- intersect(npEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="c)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], label="d)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)#
make.plot(exSpec[Inter] - exExt[Inter], Spec[Inter] - Ext[Inter], "c)")#
mtext("net div. rate - fossils", side=2, las=0, line=Liney)#
mtext("net div. rate - extant", side=1, line=Linex)#
#
dev.off()
setwd(paste(Path_base, "figures", sep=""))#
pdf("rateCors.pdf", height=6.5, width=9.75)#
# Tip rates between fossil and extant-only species#
par(mfrow=c(2,3), mar=c(4, 5, 0.5, 0.5), bty="n", las=1, mgp=c(2, 0.5, 0), tck=-0.01, cex.axis=0.9)#
Liney <- 3#
Linex <- 2#
#
# all#
edata <- fbEdata_all[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- exEdata$meanTipLambda#
names(exSpec) <- exEdata$tip.label#
exExt <- exEdata$meanTipMu#
names(exExt) <- exEdata$tip.label#
#
Inter <- intersect(exEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="a)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], "b)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)#
make.plot(exSpec[Inter] - exExt[Inter], Spec[Inter] - Ext[Inter], "c)")#
mtext("net div. rate - fossils", side=2, las=0, line=Liney)#
mtext("net div. rate - extant", side=1, line=Linex)#
#
# No Pleths#
edata <- fbEdata[[1]]#
Ext <- edata$meanTipMu#
names(Ext) <- edata$tip.label#
Spec <- edata$meanTipLambda#
names(Spec) <- edata$tip.label#
exSpec <- npEdata$meanTipLambda#
names(exSpec) <- npEdata$tip.label#
exExt <- npEdata$meanTipMu#
names(exExt) <- npEdata$tip.label#
#
Inter <- intersect(npEdata$tip.label, edata$tip.label)#
#
make.plot(exSpec[Inter], Spec[Inter], label="c)")#
mtext("speciation rate - fossils", side=2, las=0, line=Liney)#
mtext("speciation rate - extant", side=1, line=Linex)#
make.plot(exExt[Inter], Ext[Inter], label="d)")#
mtext("extinction rate - fossils", side=2, las=0, line=Liney)#
mtext("extinction rate - extant", side=1, line=Linex)#
make.plot(exSpec[Inter] - exExt[Inter], Spec[Inter] - Ext[Inter], "c)")#
mtext("net div. rate - fossils", side=2, las=0, line=Liney)#
mtext("net div. rate - extant", side=1, line=Linex)#
#
dev.off()
#### Net div calculations#
Path_base <- "~/Documents/Salamanders/"#
#
library(phytools)#
library(BAMMtools)#
library(coda)#
source(paste(Path_base, 'Rscripts/gcr.R', sep=""), chdir = TRUE)#
source('~/Documents/BAMMtools_Functions/addScale.R', chdir = TRUE)#
#
magND <- function(N, t_stem, t_crown, EpsS=0.9, EpsC=0.9)	{#
	# Eqn 6#
	#R_stem <- log(N) / t_stem#
	R_stem <- (1 / t_stem) * log( N * (1 - EpsS) + EpsS)#
	# Eqn 7#
	#R_crown <- (log(N) - log(2)) / t_crown#
	SQR <- N * ((N * EpsC^2) - (8 * EpsC) + (2 * N * EpsC) + N)#
	SQR <- sqrt(SQR)#
	Component <- (0.5 * N * (1 - EpsC^2)) + (2 * EpsC) +#
					(0.5 * (1 - EpsC) * SQR)#
	R_crown <- (1 / t_crown) * (log(Component) - log(2))#
#
	# Eqn 6#
	#R_stem <- log(N) / t_stem#
	R_stem_hi <- (1 / t_stem) * log( N * (1 - 0.9) + 0.9)#
	# Eqn 7#
	#R_crown <- (log(N) - log(2)) / t_crown#
	SQR <- N * ((N * 0.9^2) - (8 * 0.9) + (2 * N * 0.9) + N)#
	SQR <- sqrt(SQR)#
	Component <- (0.5 * N * (1 - 0.9^2)) + (2 * 0.9) +#
					(0.5 * (1 - 0.9) * SQR)#
	R_crown_hi <- (1 / t_crown) * (log(Component) - log(2))#
#
	# Eqn 6#
	#R_stem <- log(N) / t_stem#
	R_stem_lo <- (1 / t_stem) * log( N * (1 - 0.9) + 0.9)#
	# Eqn 7#
	#R_crown <- (log(N) - log(2)) / t_crown#
	SQR <- N * ((N * 0^2) - (8 * 0) + (2 * N * 0) + N)#
	SQR <- sqrt(SQR)#
	Component <- (0.5 * N * (1 - 0^2)) + (2 * 0) +#
					(0.5 * (1 - 0) * SQR)#
	R_crown_lo <- (1 / t_crown) * (log(Component) - log(2))#
	return(c(rstem=R_stem, rcrown=R_crown, rstem_hi=R_stem_hi, rcrown_hi=R_crown_hi, rstem_lo=R_stem_lo, rcrown_lo=R_crown_lo))#
}
### Calculate net diversification#
# yes pleth, extant-only#
exAges <- sapply(exFams, function(x) getAge(x, exEdata))#
exData <- rbind(exAges, exN)#
ex_ND_mag <- apply(exData, 2, function(x) #
			magND(N=x[7], t_stem=x[1], t_crown=x[2], EpsS=x[5], EpsC=x[6]))#
exAll <- rbind(exData, ex_ND_mag)#
#
# no pleth, extant-only#
npAges <- sapply(npFams, function(x) getAge(x, npEdata))#
npData <- rbind(npAges, npN)#
np_ND_mag <- apply(npData, 2, function(x) #
			magND(N=x[7], t_stem=x[1], t_crown=x[2], EpsS=x[5], EpsC=x[6]))#
npAll <- rbind(npData, np_ND_mag)#
#
# yes pleth, fossil tree#
fAll <- list()#
for (count in 1:70)	{#
	fEdata <- fbEdata_all[[count]]#
	fAges <- sapply(1:length(exFams), function(x) getAge(exFams[[x]], fEdata, Age=exAges[1,x]))#
	fData <- rbind(fAges, exN)#
	f_ND_mag <- apply(fData, 2, function(x) #
			magND(N=x[7], t_stem=x[1], t_crown=x[2], EpsS=x[5], EpsC=x[6]))#
	fAll[[count]] <- rbind(fData, f_ND_mag)#
}#
fStems <- sapply(fAll, function(x) x["gcr_stem",])#
fCrown <- sapply(fAll, function(x) x["gcr_crown",])#
#
# no pleth, fossil tree#
fnpAll <- list()#
for (count in 1:70)	{#
	fnpEdata <- fbEdata[[count]]#
	fnpAges <- sapply(1:length(npFams), function(x) getAge(npFams[[x]], fnpEdata, Age=npAges[1,x]))#
	fnpData <- rbind(fnpAges, npN)#
	fnp_ND_mag <- apply(fnpData, 2, function(x) #
			magND(N=x[7], t_stem=x[1], t_crown=x[2], EpsS=x[5], EpsC=x[6]))#
	fnpAll[[count]] <- rbind(fnpData, fnp_ND_mag)#
}#
fnpStems <- sapply(fnpAll, function(x) x["gcr_stem",])#
fnpCrown <- sapply(fnpAll, function(x) x["gcr_crown",])
npAll
pdf(paste(Path_base, "figures/netdiv_comp_all_hi.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem_hi.stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - calc.", Label="A")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="stem rate - fossilBAMM", yLab="stem rate - BAMM", Label="B")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown_hi.crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - calc.", Label="C")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - BAMM", Label="D")#
dev.off()#
#
pdf(paste(Path_base, "figures/netdiv_comp_no_pleth_hi.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fnpStems, 1, mean), npAll["rstem_hi.stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - calc.", Label="A")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - BAMM", Label="B")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown_hi.crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - calc.", Label="C")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - BAMM", Label="D")#
dev.off()
pdf(paste(Path_base, "figures/netdiv_comp_all_lo.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fStems, 1, mean), exAll["rstem_lo.stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - calc.", Label="A")#
makePlot(apply(fStems, 1, mean), exAll["gcr_stem",], xLab="stem rate - fossilBAMM", yLab="stem rate - BAMM", Label="B")#
makePlot(apply(fCrown, 1, mean), exAll["rcrown_lo.crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - calc.", Label="C")#
makePlot(apply(fCrown, 1, mean), exAll["gcr_crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - BAMM", Label="D")#
dev.off()#
#
pdf(paste(Path_base, "figures/netdiv_comp_no_pleth_lo.pdf", sep=""), height=2.5, width=10)#
par(mfrow=c(1, 4), mar=c(4,5,1,1), bty="n", las=1, mgp=c(2,0.5,0), tck=-0.01)#
makePlot(apply(fnpStems, 1, mean), npAll["rstem_lo.stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - calc.", Label="A")#
makePlot(apply(fnpStems, 1, mean), npAll["gcr_stem",], xLab="stem  rate - fossilBAMM", yLab="stem rate - BAMM", Label="B")#
makePlot(apply(fnpCrown, 1, mean), npAll["rcrown_lo.crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - calc.", Label="C")#
makePlot(apply(fnpCrown, 1, mean), npAll["gcr_crown",], xLab="crown rate - fossilBAMM", yLab="crown rate - BAMM", Label="D")#
dev.off()
